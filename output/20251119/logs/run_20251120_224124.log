2025-11-20 22:41:24,017 - INFO - Logging initialized. Log file: C:\Mini_Project\output\20251119\logs\run_20251120_224124.log
2025-11-20 22:41:24,017 - INFO - Random seed: 10
2025-11-20 22:41:24,033 - INFO - ================================================================================
2025-11-20 22:41:24,033 - INFO - HYPERPARAMETERS FOR THIS RUN
2025-11-20 22:41:24,033 - INFO - ================================================================================
2025-11-20 22:41:24,033 - INFO - Data Parameters:
2025-11-20 22:41:24,033 - INFO -   TICKER: ^NDX
2025-11-20 22:41:24,033 - INFO -   START_DATE: 2015-10-31
2025-11-20 22:41:24,033 - INFO -   END_DATE: 2025-10-31
2025-11-20 22:41:24,033 - INFO -   N_YEARS: 10
2025-11-20 22:41:24,033 - INFO -   STRIKES: [0.8, 0.85, 0.9, 0.95, 1.0, 1.05, 1.1, 1.15, 1.2]
2025-11-20 22:41:24,033 - INFO -   MATURITIES: [30, 60, 90, 120, 150, 180, 360]
2025-11-20 22:41:24,033 - INFO - 
2025-11-20 22:41:24,033 - INFO - PCA Parameters:
2025-11-20 22:41:24,033 - INFO -   N_COMPONENTS: 5
2025-11-20 22:41:24,033 - INFO - 
2025-11-20 22:41:24,033 - INFO - Data Preparation Parameters:
2025-11-20 22:41:24,033 - INFO -   SEQUENCE_LENGTH: 1000
2025-11-20 22:41:24,033 - INFO -   BATCH_SIZE: 64
2025-11-20 22:41:24,033 - INFO -   TRAIN_RATIO: 0.85
2025-11-20 22:41:24,033 - INFO - 
2025-11-20 22:41:24,033 - INFO - GAN Training Parameters:
2025-11-20 22:41:24,033 - INFO -   NOISE_DIM: 32
2025-11-20 22:41:24,033 - INFO -   EPOCHS: 25
2025-11-20 22:41:24,033 - INFO -   LEARNING_RATE_GEN: 5e-05
2025-11-20 22:41:24,033 - INFO -   LEARNING_RATE_DES: 0.0003
2025-11-20 22:41:24,033 - INFO -   BETA_PARAM: 0.3
2025-11-20 22:41:24,038 - INFO -   GEN_GRAD_CLIP: 0.5
2025-11-20 22:41:24,038 - INFO -   DISC_GRAD_CLIP: 1.0
2025-11-20 22:41:24,038 - INFO -   RANDOM_SEED: 10
2025-11-20 22:41:24,038 - INFO - 
2025-11-20 22:41:24,038 - INFO - Generation Parameters:
2025-11-20 22:41:24,038 - INFO -   GENERATE_LENGTH: 252
2025-11-20 22:41:24,038 - INFO - 
2025-11-20 22:41:24,038 - INFO - Model Training Flags:
2025-11-20 22:41:24,038 - INFO -   TRAIN_LSTM_GAN: True
2025-11-20 22:41:24,038 - INFO -   TRAIN_TCN_GAN: False
2025-11-20 22:41:24,038 - INFO - ================================================================================
2025-11-20 22:41:24,038 - INFO - 
2025-11-20 22:41:24,262 - INFO - Unified grid: 9 relative strikes, 7 time points
2025-11-20 22:41:31,361 - INFO - Loaded 2514 dates of implied volatilities data (date range: 2015-10-31 to 2025-10-31). Shape: (2514, 9, 7)
2025-11-20 22:41:31,361 - INFO - Applying PCA to log-implied volatilities series
2025-11-20 22:41:31,370 - INFO - Removing 6072 NaN values using Nadaraya-Watson smoothing
2025-11-20 22:41:32,381 - INFO - Nadaraya-Watson smoothing complete. Removed 6072 NaN values. Remaining NaN count: 0
2025-11-20 22:41:32,381 - INFO - Flattened Log-implied volatility series, shape is now: (2514, 63)
2025-11-20 22:41:32,381 - INFO - PCA explained variance: [0.80646158 0.06293389 0.05666655 0.01777199 0.01176426]
2025-11-20 22:41:32,381 - INFO - Cumulative explained variance: [0.80646158 0.86939548 0.92606202 0.94383401 0.95559827]
2025-11-20 22:41:33,795 - INFO - PCA model saved to C:\Mini_Project\output\20251119\data\pca_reducer.pkl
2025-11-20 22:41:33,795 - INFO - Preparing training data with sequence length 1000...
2025-11-20 22:41:33,814 - INFO - Normalizing training and validation data...
2025-11-20 22:41:34,020 - INFO - Normalization complete. Training data mean: 0.0000, std: 1.0000
2025-11-20 22:41:34,020 - INFO - Target data mean: -0.0000, std: 1.0000
2025-11-20 22:41:34,020 - INFO - Saved scalers to C:\Mini_Project\output\20251119\data
2025-11-20 22:41:34,096 - INFO - Created training dataset with 1286 sequences
2025-11-20 22:41:34,096 - INFO - Created validation dataset with 228 sequences
2025-11-20 22:41:34,097 - INFO - 
2025-11-20 22:41:34,098 - INFO - ================================================================================
2025-11-20 22:41:34,098 - INFO - LSTM-GAN MODEL CONFIGURATION
2025-11-20 22:41:34,098 - INFO - ================================================================================
2025-11-20 22:41:34,099 - INFO - Training LSTM-GAN model with 25 epochs
2025-11-20 22:41:34,099 - INFO - 
2025-11-20 22:41:34,099 - INFO - Model Architecture:
2025-11-20 22:41:34,099 - INFO -   state_dim: (None, 1000, 5)
2025-11-20 22:41:34,100 - INFO -   noise_dim: 32
2025-11-20 22:41:34,100 - INFO -   output_dim: 5
2025-11-20 22:41:34,100 - INFO -   generator_units: [64, 128]
2025-11-20 22:41:34,100 - INFO -   discriminator_units: [128, 64]
2025-11-20 22:41:34,100 - INFO -   use_pca: True
2025-11-20 22:41:34,100 - INFO -   n_pca_components: 5
2025-11-20 22:41:34,100 - INFO - 
2025-11-20 22:41:34,101 - INFO - Training Hyperparameters:
2025-11-20 22:41:34,101 - INFO -   Learning Rate (Generator): 5e-05
2025-11-20 22:41:34,101 - INFO -   Learning Rate (Discriminator): 0.0003
2025-11-20 22:41:34,101 - INFO -   Beta (Adam optimizer): 0.3
2025-11-20 22:41:34,101 - INFO -   Generator Gradient Clipping: 0.5
2025-11-20 22:41:34,101 - INFO -   Discriminator Gradient Clipping: 1.0
2025-11-20 22:41:34,102 - INFO -   Random Seed: 10
2025-11-20 22:41:34,102 - INFO - ================================================================================
2025-11-20 22:41:34,102 - INFO - 
2025-11-20 22:43:16,252 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-11-20 22:43:16,268 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-11-20 22:43:16,285 - INFO - LSTM-GAN model saved to C:\Mini_Project\output\20251119\data\lstm_gan_model
2025-11-20 22:43:16,669 - INFO - Saved GAN loss plot to C:\Mini_Project\output\20251119\data\plots\lstm_gan_losses.png
2025-11-20 22:43:16,958 - INFO - Saved combined GAN loss plot to C:\Mini_Project\output\20251119\data\plots\lstm_gan_losses_combined.png
2025-11-20 22:43:16,958 - INFO - Generating synthetic data and evaluating models
2025-11-20 22:43:16,958 - INFO - Loaded scalers for denormalization
2025-11-20 22:43:16,958 - INFO - Generating and evaluating LSTM-GAN...
2025-11-20 22:43:37,040 - INFO - Denormalizing generated sequence before inverse PCA transform
2025-11-20 22:43:40,185 - INFO - 
Model Comparison:
2025-11-20 22:43:40,191 - INFO - 
                       LSTM-GAN
MSE                    0.121435
MAE                    0.121435
Wasserstein            0.081266
KL Divergence          0.395522
JS Divergence          0.059011
ACF MSE                0.019606
Cross-Correlation MSE  0.065297
Volatility ACF MSE     0.006213
2025-11-20 22:43:40,194 - INFO - Saving real and generated data, transforming to IVs, and calculating Black-Scholes prices...
2025-11-20 22:43:40,208 - INFO - Loaded underlying prices for 252 dates
2025-11-20 22:43:40,299 - INFO - Loaded 252 risk-free rates from EFFR for dates
2025-11-20 22:43:40,328 - INFO - Saved real log-IV data to C:\Mini_Project\output\20251119\data\real_data/log_implied_vols.csv
2025-11-20 22:43:40,350 - INFO - Saved real IV data to C:\Mini_Project\output\20251119\data\real_data/implied_vols.csv
2025-11-20 22:43:40,351 - INFO - Verification: Real IVs vs Original IVs - Max difference: 0.000000, Mean difference: 0.000000
2025-11-20 22:43:40,351 - INFO - Real IVs match original IVs (within tolerance)
2025-11-20 22:43:41,511 - INFO - Saved real option prices to C:\Mini_Project\output\20251119\data\real_data/option_prices.csv
2025-11-20 22:43:41,525 - INFO - Saved LSTM-GAN generated log-IV data to C:\Mini_Project\output\20251119\data\generated_data\lstm_gan/log_implied_vols.csv
2025-11-20 22:43:41,541 - INFO - Saved LSTM-GAN generated IV data to C:\Mini_Project\output\20251119\data\generated_data\lstm_gan/implied_vols.csv
2025-11-20 22:43:42,661 - INFO - Saved LSTM-GAN generated option prices to C:\Mini_Project\output\20251119\data\generated_data\lstm_gan/option_prices.csv
2025-11-20 22:43:42,661 - INFO - Finished saving all data and calculating Black-Scholes prices.
