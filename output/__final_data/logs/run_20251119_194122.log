2025-11-19 19:41:22,852 - INFO - Logging initialized. Log file: C:\Mini_Project\output\20251119\logs\run_20251119_194122.log
2025-11-19 19:41:22,852 - INFO - Random seed: 1
2025-11-19 19:41:23,657 - INFO - Unified grid: 9 relative strikes, 7 time points
2025-11-19 19:41:35,321 - INFO - Loaded 2514 dates of implied volatilities data (date range: 2015-10-31 to 2025-10-31). Shape: (2514, 9, 7)
2025-11-19 19:41:35,321 - INFO - Applying PCA to log-implied volatilities series
2025-11-19 19:41:35,330 - INFO - Removing 6072 NaN values using Nadaraya-Watson smoothing
2025-11-19 19:41:36,933 - INFO - Nadaraya-Watson smoothing complete. Removed 6072 NaN values. Remaining NaN count: 0
2025-11-19 19:41:36,935 - INFO - Flattened Log-implied volatility series, shape is now: (2514, 63)
2025-11-19 19:41:36,939 - INFO - PCA explained variance: [0.80646158 0.06293389 0.05666655 0.01777199 0.01176426]
2025-11-19 19:41:36,940 - INFO - Cumulative explained variance: [0.80646158 0.86939548 0.92606202 0.94383401 0.95559827]
2025-11-19 19:41:41,394 - INFO - PCA model saved to C:\Mini_Project\output\20251119\data\pca_reducer.pkl
2025-11-19 19:41:41,394 - INFO - Preparing training data with sequence length 1000...
2025-11-19 19:41:41,417 - INFO - Training data shape: (1286, 1000, 5), Validation data shape: (228, 1000, 5)
2025-11-19 19:41:41,417 - INFO - Normalizing training and validation data...
2025-11-19 19:41:41,691 - INFO - Normalization complete. Training data mean: 0.0000, std: 1.0000
2025-11-19 19:41:41,691 - INFO - Target data mean: -0.0000, std: 1.0000
2025-11-19 19:41:41,691 - INFO - Saved scalers to C:\Mini_Project\output\20251119\data
2025-11-19 19:41:41,787 - INFO - Created training dataset with 1286 sequences
2025-11-19 19:41:41,788 - INFO - Created validation dataset with 228 sequences
2025-11-19 19:41:41,788 - INFO - Training LSTM-GAN model with 20 epochs
2025-11-19 19:43:03,760 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-11-19 19:43:03,795 - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-11-19 19:43:03,830 - INFO - LSTM-GAN model saved to C:\Mini_Project\output\20251119\data\lstm_gan_model
2025-11-19 19:43:04,575 - INFO - Saved GAN loss plot to C:\Mini_Project\output\20251119\data\plots\lstm_gan_losses.png
2025-11-19 19:43:05,088 - INFO - Saved combined GAN loss plot to C:\Mini_Project\output\20251119\data\plots\lstm_gan_losses_combined.png
2025-11-19 19:43:05,088 - INFO - Generating synthetic data and evaluating models
2025-11-19 19:43:05,104 - INFO - Loaded scalers for denormalization
2025-11-19 19:43:05,104 - INFO - Generating and evaluating LSTM-GAN...
2025-11-19 19:43:17,681 - INFO - Denormalizing generated sequence before inverse PCA transform
2025-11-19 19:43:22,683 - INFO - 
Model Comparison:
2025-11-19 19:43:22,691 - INFO - 
                        LSTM-GAN
MSE                     0.255595
MAE                     0.255595
Wasserstein             0.411109
KL Divergence          15.972232
JS Divergence           0.443888
ACF MSE                 0.106433
Cross-Correlation MSE   0.033052
Volatility ACF MSE      0.016868
2025-11-19 19:43:22,695 - INFO - Saving real and generated data, and converting to IVs and prices...
2025-11-19 19:43:22,757 - INFO - Loaded underlying prices for 100 dates
2025-11-19 19:43:22,885 - INFO - Loaded 100 risk-free rates from EFFR for validation dates
2025-11-19 19:43:22,885 - INFO - Using 100 risk-free rates (one per date) for price conversion
2025-11-19 19:43:22,901 - INFO - Saved real log-IV data to C:\Mini_Project\output\20251119\data\real_data/log_implied_vols.csv
2025-11-19 19:43:22,912 - INFO - Saved real IV data to C:\Mini_Project\output\20251119\data\real_data/implied_vols.csv
2025-11-19 19:43:23,660 - INFO - Saved real option prices to C:\Mini_Project\output\20251119\data\real_data/option_prices.csv
2025-11-19 19:43:23,675 - INFO - Saved LSTM-GAN generated log-IV data to C:\Mini_Project\output\20251119\data\generated_data\lstm_gan/log_implied_vols.csv
2025-11-19 19:43:23,696 - INFO - Saved LSTM-GAN generated IV data to C:\Mini_Project\output\20251119\data\generated_data\lstm_gan/implied_vols.csv
2025-11-19 19:43:24,477 - INFO - Saved LSTM-GAN generated option prices to C:\Mini_Project\output\20251119\data\generated_data\lstm_gan/option_prices.csv
2025-11-19 19:43:24,477 - INFO - Finished saving all data and converting to IVs and prices.
